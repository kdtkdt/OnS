<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ons.study.dao.RecruitmentDAO">

<resultMap type="com.ons.study.dto.RecruitmentDTO" id="recruitmentmap">
	<id property="id" column="c_id"/>
	<result property="user_id" column="user_id"/>
	<result property="title" column="title"/>
	<result property="contents" column="contents"/>
	<result property="created_time" column="created_time"/>
	<result property="updated_time" column="updated_time"/>
	<result property="board_type" column="board_type"/>
	<result property="like" column="like"/>
	<result property="view_count" column="view_count"/>
	<collection property="study" resultMap="studyMap"></collection>
	<collection property="skill" resultMap="skillMap"></collection>
	<collection property="user" resultMap="userMap"></collection>
	<collection property="comment" resultMap="commentMap"></collection>
<!-- 	<collection property="member" resultMap="memberMap"></association> -->
</resultMap>


<resultMap type="com.ons.study.dto.SkillDTO" id="skillMap">
	<id property="study_group_id" column="study_group_id"/>
	<result property="id" column="s_id"/>
	<result property="name" column="name"/>
</resultMap>
<select id="recruitmentList" resultMap="recruitmentmap">
select c.id as c_id, s.id as s_id, user_id, title, contents, created_time, updated_time, board_type, `like`,
 view_count, study_group_id, name
from content c
inner join skill s on c.id = s.study_group_id where board_type =1
</select>

<resultMap type="com.ons.study.dto.StudyDTO" id="studyMap">
	<id property="id" column="s_id"/>
	<result property="name" column="name"/>
	<result property="recruit_period" column="recruit_period"/>
	<result property="start_date" column="start_date"/>
	<result property="end_date" column="end_date"/>
	<result property="total_member" column="total_member"/>
</resultMap>
<select id="recruitmentList2" resultMap="recruitmentmap">
select c.id as c_id, s.id as s_id, user_id, title, contents, created_time, updated_time, board_type, `like`,
 view_count, name, recruit_period, start_date, end_date, total_member
from content c
inner join study_group s on c.id = s.id where board_type =1
</select>

<resultMap type="com.ons.study.dto.UserDTO" id="userMap">
	<id property="id" column="u_id"/>
	<result property="email" column="user_email"/>
	<result property="password" column="password"/>
	<result property="nickname" column="nickname"/>
</resultMap>
<select id="recruitmentList3" resultMap="recruitmentmap">
select c.id as c_id, u.id as u_id, c.user_id, title, contents, created_time, updated_time, board_type, `like`,
 view_count, user_email, password, nickname
from content c
inner join user u on c.user_id = u.id where board_type =1
</select>

<select id="recruitmentpostview" resultMap="recruitmentmap"  parameterType="int">
select c.id as c_id, u.id as u_id, c.user_id, title, contents, created_time, updated_time, board_type, `like`,
 view_count, user_email, password, nickname
from content c
inner join user u on c.user_id = u.id where c.board_type =1 and c.id=#{id}
</select>

<select id="commentuserinfo" resultMap="commentMap"  parameterType="int">
select c.*, u.*
from comment c
inner join user u on c.user_id = u.id where c.content_id=#{id}
</select>

<resultMap type="com.ons.study.dto.CommentDTO" id="commentMap">
	<id property="id" column="c_id"/>
	<result property="contentId" column="content_id"/>
	<result property="userId" column="c_user_id"/>
	<result property="parentId" column="parent_id"/>
	<result property="contents" column="c_contents"/>
	<result property="createdTime" column="c_created_time"/>
	<result property="updatedTime" column="c_updated_time"/>
	<collection property="user" resultMap="userMap"></collection>
</resultMap>
<select id="postviewcomment" resultMap="recruitmentmap" parameterType="int">
select c.id as c_id, content_id, c.user_id as c_user_id, parent_id, c.contents as c_contents, c.created_time as c_created_time, c.updated_time as c_updated_time
from content t
inner join comment c on t.id = content_id where board_type =1 and t.id=#{id}
</select>

</mapper>